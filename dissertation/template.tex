%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Overleaf (WriteLaTeX) Example: Molecular Chemistry Presentation
%
% Source: http://www.overleaf.com
%
% In these slides we show how Overleaf can be used with standard 
% chemistry packages to easily create professional presentations.
% 
% Feel free to distribute this example, but please keep the referral
% to overleaf.com
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% How to use Overleaf: 
%
% You edit the source code here on the left, and the preview on the
% right shows you the result within a few seconds.
%
% Bookmark this page and share the URL with your co-authors. They can
% edit at the same time!
%
% You can upload figures, bibliographies, custom classes and
% styles using the files menu.
%
% If you're new to LaTeX, the wikibook is a great place to start:
% http://en.wikibooks.org/wiki/LaTeX
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[hyperref={colorlinks,citecolor=blue,linkcolor=blue,urlcolor=blue}]{beamer}

% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{Madrid}       % or try default, Darmstadt, Warsaw, ...
  \usecolortheme{default} % or try albatross, beaver, crane, ...
  \usefonttheme{serif}    % or try default, structurebold, ...
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
} 

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{chemfig}
\usepackage[version=3]{mhchem}
\usepackage{tikz}
\usetikzlibrary{plotmarks}
\usepackage{pgfplots}
\usepackage{lineno}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{subcaption}
\usepackage{pgf}  
\usepackage{svg}

\newlength\figureheight
\newlength\figurewidth
% \addtobeamertemplate{navigation symbols}{}{%
%     \usebeamerfont{footline}%
%     \usebeamercolor[fg]{footline}%
%     \hspace{5em}%
%     \insertframenumber/\inserttotalframenumber
% }

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}[frame number]{}

% On Overleaf, these lines give you sharper preview images.
% You might want to `comment them out before you export, though.
\usepackage{pgfpages}
\pgfpagesuselayout{resize to}[%
  physical paper width=8in, physical paper height=6in]

% Here's where the presentation starts, with the info for the title slide
\title[]{Optimization test of Interconnected Natural Gas and Power Systems Using Mathematical Programs with Complementarity Constraints}
\author{Cristian Alejandro Blanco Martínez}
\institute{Universidad Tecnológica de Pereira \\ 
Grupo de investigación Automática}
\date{\today}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

% These three lines create an automatically generated table of contents.
\begin{frame}{Outline}
  \tableofcontents
\end{frame}

\section{Introduction}
\begin{frame}{Introduction}
\begin{itemize}
    \item Project: Development of a tool for long-term planning of the operation of Colombia's natural gas transportation system.

    \item  Objective: Develop a stochastic and/or exact optimization strategy to find a set of alternatives and their respective execution periods for the long-term planning of Colombia's natural gas transportation network, so as to minimize operating and investment costs, considering the current infrastructure of the system and the prediction models developed.

\end{itemize}


\end{frame}

\section{Interconnected System}
\begin{frame}{Power system}

\begin{figure}
    \centering
    \includegraphics[scale=0.6]{only_power.pdf}
    \caption{Caption}
    \label{fig:enter-label}
\end{figure}
\end{frame}

\subsection{Power System}
\begin{frame}{Power system} 
\begin{figure}
    \centering
    \includegraphics[scale=0.6]{power_labels.pdf}
    \caption{Caption}
    \label{fig:enter-label}
\end{figure}
\end{frame}

\subsection{Gas system}
\begin{frame}{Interconnected system} 
\begin{figure}
    \centering
    \includegraphics[scale=0.6]{powe-gas.pdf}
    \caption{Caption}
    \label{fig:enter-label}
\end{figure}
\end{frame}

\begin{frame}{Interconnected System} 
\begin{figure}
    \centering
    \includegraphics[scale=0.6]{interconnected-full.pdf}
    \caption{Caption}
    \label{fig:enter-label}
\end{figure}
\end{frame}

\begin{frame}{Interconnected system - Definition}
A power-gas interconnected system is a hybrid infrastructure that integrates natural gas and power networks, enhancing overall system efficiency~\cite{Duan_Liu_Yang_2022}. Its key components include power generators, transmission lines, consumption buses, gas wells, pipelines, compressor stations, gas storage units, and consumption nodes. 
    
\end{frame}



\subsection{Model formulation}
\begin{frame}{Objective function}
\begin{columns}
\begin{column}{0.5\textwidth}
   \begin{center}
     \includegraphics[width=1.1\textwidth]{network_math_alternative.pdf}
     \end{center}
\end{column}
\begin{column}{0.5\textwidth}  %%<--- here
\begin{equation} \label{eq:obj_func_integrated}
\begin{split}
\min_{\mathcal{P}, \mathcal{F}} \quad  \sum_{g \in \mathcal{G}} C_{g}^t {P_{g}^t} + \sum_{d \in \mathcal{D}} C_{d}^t {P_{d}^t} +  \\ \sum_{w \in \mathcal{W}} C_{w}^t {f_{w}^t} +  \sum_{p \in \mathcal{P}} C_{p}^t {f_{p}^t}  + \\ \sum_{c \in \mathcal{C}} C_{c}^t {f_{c}^t} + \sum_{u \in \mathcal{U}} C_{u}^{t} {f_{u}^{t}} + \\ \quad \sum_{s \in \mathcal{S}} C_{s+}^{t} {f_{s+}^{t}}  + \sum_{s \in \mathcal{S}} C_{s-}^{t} {f_{s-}^{t}} + \\ \sum_{s \in \mathcal{S}} C_{s}^{t} {V_{s}^{t}}
\end{split}
\end{equation}
    
\end{column}
\end{columns}
\end{frame}

\begin{frame}{Power system constraints}

The constraints of the electrical system represent the technical limits of the different elements that compose it, as well as the physical laws that govern it. For certain applications, the DC model is sufficient~\cite{8468081}.

\begin{columns}
\begin{column}{0.24\textwidth}
% \begin{center}
\vspace{3pt}
    \includegraphics[width=1.4\textwidth]{power_dummy_constraint.png}
% \end{center}
\end{column}
\begin{column}{0.8\textwidth}  %%<--- here

\begin{subequations}
\begin{alignat}{4}
    \underline{P_g^t} \leq P_{g}^t \leq \overline{P_g^t} &\quad \forall \ g \in \mathcal{G}, \label{eq:gen_limits} \\
    -\overline{P_l^t} \leq P_{l}^t \leq \overline{P_l^t} &\quad \forall \ l \in \mathcal{L}, \label{eq:line_limits} \\
    P_{l}^t = B_{nm}(\theta_n - \theta_{m}) &\quad \forall \ l = (n, m) \in \mathcal{L} , \label{eq:dc_power_flow} \\
    0 \leq P_{d}^t \leq \overline{P_{d}^t} &\quad \forall \ d \in \mathcal{D}, \label{eq:dem_limit_power} \\
    -\overline{\theta_{n}^t} \leq \theta_{m}^t \leq \overline{\theta_{n}^t} &\quad \forall \ n \in \mathcal{N}_P, \label{eq:voltage_angle_limits} \\
    \sum_{\substack{l\in \mathcal{L}_{n+}\\g=n}}{P_{l}^t + P_{g}^t} =  \sum_{\substack{l\in \mathcal{L}_{n-}\\d=n}} P_{l}^t + P_{d}^t &\quad \forall \ n \in \mathcal{N}_P \label{eq:power_balance} 
    % + \sum\limits_{n \in \mathcal{G}} P_{n}^t - \sum\limits_{n \in \mathcal{D}} P_{n}^t = 0 \quad \forall \ n,m \in \mathcal{N}_P \label{eq:power_balance} 
\end{alignat}
\end{subequations}

\end{column}
\end{columns}
\end{frame}


\begin{frame}{Interconnection constraints}
The second set of restrictions interconnects the natural gas and electric power systems through gas-fired power plants that generate electricity.  $f_{n}^t$ stands for the natural gas fuel consumption to generate a power $P_{n}^t$ at generator bus $n\in\mathcal{N}_I$, the heat-rate $\text{HR}_n$ defines the generator efficiency, and the set $\mathcal{N}_I=\mathcal{G}\cap\mathcal{U}$ holds all the units in the interconnected system belonging to both the power generator and gas demand sets.
    \begin{align}
    &f_{n}^t = P_{n}^t \cdot \text{HR}_n, \quad \forall \ n \in \mathcal{N}_I, \label{eq:gas_power_relation} 
\end{align}
\end{frame}


\begin{frame}{Gas system constraints}

This set of constraints ensures that wells, pipelines, nodal pressures, compressors, unsupplied demand and storage facilities operate within proper operating limits.~\cite{MPNG}.

\begin{columns}
\begin{column}{0.24\textwidth}
% \begin{center}
% \vspace{3pt}
    \includegraphics[width=1.5\textwidth]{gas_dummy.png}
% \end{center}
\end{column}
\begin{column}{0.8\textwidth}  %%<--- here

 \begin{subequations}
\begin{alignat}{4}
    \underline{f_{w}^t} \leq f_{w}^t \leq \overline{f_{w}^t} &\quad \forall \ w \in \mathcal{W} \label{eq:well_limits} \\
    -\overline{f_{p}^t} \leq f_{p}^t \leq \overline{f_{p}^t} &\quad \forall \ p \in \mathcal{P} \label{eq:pipe_limits} \\
    \underline{\pi_{n}^t} \leq \pi_{n}^t \leq \overline{\pi_{n}^t} &\quad \forall \ n \in \mathcal{N}_f \label{eq:press_limit} \\
    \pi_{m}^t \leq \beta_{c}^t{\pi_{n}^t} &\quad \forall c=(n,m) \in \mathcal{C} \label{eq:comp_ratio} \\
    0 \leq f_{u}^{t} \leq \overline{f_{u}^{t}} &\quad \forall \ u \in \mathcal{U} \label{eq:dem_limit_gas} \\
    % \sum_{m:(m,n)\in\mathcal{A}}{f_{m}^t} = \sum_{m':(n,m')\in\mathcal{A}}{f_{m'}^t} &\quad \forall \ n \in \mathcal{N}_f \label{eq:gas_balance} \\
    0 \leq f_{s+}^t \leq V_{0s} - \underline{V_s} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_limit1} \\ 
    0 \leq f_{s-}^t \leq \overline{V_s} - V_{0s} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_limit2} \\ 
    V_{s}^t = V_{s}^{t-1} + f_{s-}^{t-1} - f_{s+}^{t-1} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_time}\\
    % sgn(f_{p}^t)(f_{p}^t)^2 = K_{nm}((\pi_{n}^t)^2-(\pi_{m}^t)^2) &\quad \forall \ p =(n,m) \in\mathcal{P} \label{eq:weymouth_cons}
\end{alignat}
\end{subequations}
\end{column}
\end{columns}
\end{frame}

\subsection{Weymouth equation}

\begin{frame}{Gas system constraints}
The gas balance constraints guarantee that the amount of gas entering a node equals the amount leaving it. On the other hand, the Weymouth equation encapsulates the complex physics of gas flow through pipelines between flow rates and pressures. 


 \begin{subequations}
\begin{alignat}{4}
    % \underline{f_{w}^t} \leq f_{w}^t \leq \overline{f_{w}^t} &\quad \forall \ w \in \mathcal{W} \label{eq:well_limits} \\
    % -\overline{f_{p}^t} \leq f_{p}^t \leq \overline{f_{p}^t} &\quad \forall \ p \in \mathcal{P} \label{eq:pipe_limits} \\
    % \underline{\pi_{n}^t} \leq \pi_{n}^t \leq \overline{\pi_{n}^t} &\quad \forall \ n \in \mathcal{N}_f \label{eq:press_limit} \\
    % \pi_{m}^t \leq \beta_{c}^t{\pi_{n}^t} &\quad \forall c=(n,m) \in \mathcal{C} \label{eq:comp_ratio} \\
    % 0 \leq f_{u}^{t} \leq \overline{f_{u}^{t}} &\quad \forall \ u \in \mathcal{U} \label{eq:dem_limit_gas} \\
    \sum_{m:(m,n)\in\mathcal{A}}{f_{m}^t} = \sum_{m':(n,m')\in\mathcal{A}}{f_{m'}^t} &\quad \forall \ n \in \mathcal{N}_f \label{eq:gas_balance} \\
    % 0 \leq f_{s+}^t \leq V_{0s} - \underline{V_s} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_limit1} \\ 
    % 0 \leq f_{s-}^t \leq \overline{V_s} - V_{0s} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_limit2} \\ 
    % V_{s}^t = V_{s}^{t-1} + f_{s-}^{t-1} - f_{s+}^{t-1} &\quad \forall \ s \in \mathcal{S} \label{eq:sto_time}\\
    sgn(f_{p}^t)(f_{p}^t)^2 = K_{nm}((\pi_{n}^t)^2-(\pi_{m}^t)^2) &\quad \forall \ p =(n,m) \in\mathcal{P} \label{eq:weymouth_cons}
\end{alignat}
\end{subequations}

Modeling this equation as a nonconvex and discontinuous equality constraint poses significant challenges for optimization algorithms. Specifically, the nonconvexity leads to multiple local optima, making it difficult to find the global optimum~\cite{JIANG2021106460}.
\end{frame}


\begin{frame}{Different solutions to the Weymouth equation}
The challenges posed by accurately modeling the Weymouth equation in optimization algorithms has driven researchers to develop a variety of approaches that balance model complexity, accuracy and computational tractability~\cite{weymouth_challenge_intro}
        \begin{figure}
            \centering
            \includegraphics[scale=0.4]{cuadro.pdf}
            \label{fig:enter-label}
        \end{figure}   
\end{frame}

\begin{frame}{Multi-objective optimization}
Multi-objective optimization is an area of multiple-criteria decision making that is concerned with mathematical optimization problems involving more than one objective function to be optimized simultaneously. 
\begin{equation} \label{eq:obj_multi}
% \begin{split}
\min_{x} \quad (f_1(x), f_2(x))
\end{equation}
\end{frame}

\begin{frame}{Multi-objective optimization}
In multi-objective optimization, there does not typically exist a feasible solution that minimizes all objective functions simultaneously. Therefore, attention is paid to Pareto optimal solutions.
    \begin{figure}[ht]
        \centering
        \includegraphics[scale=0.35]{Front_pareto.svg.png}
        \caption{Example of a Pareto frontier.}
        \label{fig:enter-label}
    \end{figure}
\end{frame}



\subsection{Proposed solution}
\begin{frame}{Proposed complementarity-based approach}
     Complementarity constraints can be used to represent non-uniform or discontinuous operators, such as absolute value, sign, and min/max \cite{mpcc}.
    \begin{gather}
            y = sgn(f_{T}^t)  \label{eq:sign}
    \end{gather}
    The sign equation can be represented by an optimization problem whose constraints avoid the use of binary variables.

\begin{subequations}
\begin{alignat}{4}
\label{eq:complementarity_relaxec3}
\mathcal{O}_W: \ &\min\limits_{y_p^t} -y_p^tf_{p}^t \\
& \text{s.t. } y_p^t(f_{p}^t)^2 = K_{nm}((\pi_{n}^t)^2-(\pi_{m}^t)^2)\\
& -1 \leq y_p^t \leq 1 \\
&f_{p}^t = f_{p+}^t - f_{p-}^t\\
& 0 \leq f_{p+}^t \perp (y_p^t+1) \geq 0 \\
& 0 \leq f_{p-}^t \perp (1-y_p^t) \geq 0
\end{alignat}
\end{subequations}
\end{frame}


\begin{frame}{Proposed complementarity-based approach}
   The program $\mathcal{O}_W$ misses the KKT conditions, because the conventional constraint qualifications for nonlinear programming are typically not satisfied in the case of MPCC~\cite{Bouza_Still_2007}. Hence, instead of working with the original problem, the relaxed problem $\mathcal{O}_\epsilon$ is considered:
\begin{subequations}
\begin{alignat}{4}
\label{eq:complementarity_relaxec1}
\mathcal{O}_\epsilon: \ &\min\limits_{y_p^t} -y_p^tf_{p}^t \\
&\text{s.t. } y_p^t(f_{p}^t)^2 = K_{nm}((\pi_{n}^t)^2-(\pi_{m}^t)^2)\\
&f_{p}^t = f_{p+}^t - f_{p-}^t\\
& -1 \leq y_p^t \leq 1 \\
&\quad f_{p+}^t(y_p^t+1) \leq \epsilon\label{eq:Oe:complementarity1} \\ \label{eq:Oe:complementarity2}
&\quad f_{p-}^t(1-y_p^t) \leq \epsilon
\end{alignat}
\end{subequations}
    The regularized optimization model $\mathcal{O}_{\epsilon}$ offers several key properties that justify its use in tackling challenging MPCC problems~\cite{Ralph_Wright_2004}.
\end{frame}


\section{Experimental setup}
\begin{frame}{Databases}
Each of the mentioned databases was selected based on its unique characteristics and the significant contributions it could make to the study.

\begin{table}[]
\begin{tabular}{|c|c|c|c|c|}
\hline
                & \textbf{Topology}                                           & \textbf{\begin{tabular}[c]{@{}c@{}}Connection \\ points\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Closed\\ loops\end{tabular}} & \textbf{Problem}                                                                               \\ \hline
\textbf{Case 1} & \begin{tabular}[c]{@{}c@{}}9-bus\\ 8-system\end{tabular}    & 1                                                                          & 1                                                                      & \begin{tabular}[c]{@{}c@{}}Small system\\ with one loop\end{tabular}                           \\ \hline
\textbf{Case 2} & \begin{tabular}[c]{@{}c@{}}118-bus\\ 48-system\end{tabular} & 9                                                                          & 7                                                                      & \begin{tabular}[c]{@{}c@{}}Contains several\\ interconnected \\ loops\end{tabular}             \\ \hline
\textbf{Case 3} & \begin{tabular}[c]{@{}c@{}}96-bus\\ 63-system\end{tabular}  & 10                                                                         & 0                                                                      & \begin{tabular}[c]{@{}c@{}}Fully radial \\ but considers  \\ bidirectional flows.\end{tabular} \\ \hline
\end{tabular}
\caption{Databses used in the study}
\label{tab:databases}
\end{table}
\end{frame}

\begin{frame}{Experimental setup}
In order to establish a baseline for comparison, two alternative methodologies were employed: 
\begin{itemize}
    \item Taylor series approximation \cite{taylor_paper}.
    \item Second Order Cone Programming (SOC) \cite{soc_paper}.
\end{itemize}

The objective function value for each of the mentioned databases was computed by solving the optimization problem using: 
\begin{itemize}
    \item The IPOPT \cite{ipopt} solver.
    \item The GEKKO \cite{gekko} package. 
\end{itemize}

\end{frame}

\begin{frame}{Experimental setup}
    Since understanding and quantifying the inherent errors introduced by any constraint approximation approach supports its real-world pertinence, the considered validation trades off the reached cost function and constraint error values.

    \begin{equation}
    {WE}_p^t = |f_{p}^t - \left(K_{nm}|(\pi_{n}^t)^2-(\pi_{m}^t)^2|\right)^{1/2}| , \quad \forall \ p =(n,m) \in\mathcal{P}
\end{equation}
Hence, ${WE}_p^t$ metric explains the inherent sensitivity of tested approaches and validates the significance of their differences.
\end{frame}



\section{Results}
\begin{frame}{Results - Case 1}
To assess the performance of Weymouth approximation approaches on the 8/9 system, a Monte Carlo experiment estimates the cost function and Weymouth error distributions by solving  the optimization problem for one single day one hundred times with uniformly sampled natural gas demands. 

    \begin{figure}[!htb]
    \centering
    \setlength\figurewidth{.7\textwidth}        
    \setlength\figureheight{0.35\textwidth}
    % \input{images/blue_test_cost_SOC}
    \input{results/all_test_cost}
    \caption{Cost function histogram attained for the Taylor, SOC, and MPCC Weymouth approximation approaches.}
    \label{fig:blue_test_cost}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 1}
The boxplot examination reveals significantly lower approximation errors on the proposed complementarity constraints approach over key network arcs.

\begin{figure}[!htb]
    \centering
    \setlength\figurewidth{0.8\textwidth}        
    \setlength\figureheight{0.5\textwidth}
    \input{results/blue_test_boxplot}
    \caption{Boxplot of Weymouth error distribution for each pipeline in the 8/9 system attained by contrasted approximation approaches.}
    \label{fig:blue_test_boxplot}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 2}
It is worth noting that both baselines yielded the same objective function values. The consistently positive relative difference indicates that the complementarity constraints formulation always yields larger cost values than Taylor and SOC for the 118/48 system.

\begin{figure}[!htb]
    \centering
    \setlength\figurewidth{0.75\textwidth}        
    \setlength\figureheight{0.35\textwidth}
    \input{results/green_test_hist}
    \caption{Histogram depicting the relative frequencies of cost differences obtained between MPCC and the other approaches in the 48-node 118-bus system.}
    \label{fig:green_test_cost}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 2}
Contrarily to cost function analysis, Weymouth approximation results reveal a significant error reduction of about seven orders of magnitude (from $10^1$ to $10^{-6}$) under the proposed complementarity constraints.
\begin{figure}[!htb]
\setlength\figurewidth{0.37\textwidth}        
\setlength\figureheight{0.4\textwidth}
\subfloat[Taylor]{\input{results/green_test_error_Taylor}}
\subfloat[SOC]{\input{results/green_test_error_SOC}}
\subfloat[MPCC]{\input{results/green_test_error_MPCC}}
\caption{Weymouth approximation errors for each pipeline $p$ reached by Taylor (left), SOC (center), and MPCC (right) approaches in the 118/48 system.}\label{fig:green_test_error}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 3}
Instead of estimating the distributions of the objective function and Weymouth error as in cases 9/8 and 118/48, the 96/63 case validates the Weymouth approximations in an operation case of ten consecutive days ($\left | \mathcal{T} \right | = 10 $) with randomly changing gas extraction costs.
    \begin{figure}[!htb]
    \centering
    \setlength\figurewidth{0.8\textwidth}        
    \setlength\figureheight{0.4\textwidth}
    \input{results/red_test_costs}
    \caption{Daily operating cost obtained with each of the approaches in the 63-node 96-bus system.}
    \label{fig:red_test_cost}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 3}
    Regarding the Weymouth approximation analysis, the figure presents the error distribution and its relationship with the gas flow and the scheduled day for Taylor, SOC, and MPCC

    \begin{figure}[!htb]
\setlength\figurewidth{0.37\textwidth}        
\setlength\figureheight{0.4\textwidth}
\subfloat[Relative Frequency]{\label{fig:case3error}\input{results/pruebatikz}}
\subfloat[Pipeline flow ($f_m^t$)]{\label{fig:case3flow}\input{results/redtest_scatter_flow1.tex}}
\subfloat[Operation day ($t$)]{\label{fig:case3day}\input{results/err_day}}
\caption{Errors in the Weymouth equation expressed in three different formats- general error, error per flow, and error per day.}\label{fig:red_test_error}
\end{figure}
\end{frame}


\begin{frame}{Results - Case 3}
As a hypothesis, fixing the pressure at the injection well and the flow direction at compressor nine pushes the complementarity constraints to the limits and forces the compressor to augment the pressure ratio to satisfy the forthcoming branch demand.

\begin{figure}[!htb]
    \centering
    % \setlength\figurewidth{.8\textwidth}        
    % \setlength\figureheight{0.45\textwidth}
    % \input{images/blue_test_cost_SOC}
    \includegraphics[scale=1]{results/partial_network.png}
    \caption{Outlying connection of well-compressor-pipeline on the system 96/63 used in Case Study III.}
    \label{fig:96 63partial network}
\end{figure}
    
\end{frame}

\section{Conclusions and future work}

\begin{frame}{Conclusions}
The MPCC-based formulation benefits the optimization problems in interconnected power and gas systems in two main aspects. 
\begin{itemize}
    \item The complementarity constraints avoid costly mixed-integer approximations by introducing binary-behaving continuous variables related to the flow direction. 
    \item The mathematical program with complementarity constraints inherently captures the complexity in the signum function, resulting in a rigorous approximation of the Weymouth equation.
\end{itemize}
\end{frame}

\begin{frame}{Future work}
    
    \begin{itemize}
        \item Adopting a stochastic approach to the optimization of interconnected systems is crucial because of the inherent uncertainties associated with real-world energy networks, allowing a range of possible scenarios to be considered and decisions to be made that are robust under a variety of conditions.
    \end{itemize}
    
    \begin{itemize}
        \item GNNs stand out for their ability to capture complex relationships within interconnected networks, allowing them to more effectively model the uncertainty inherent in interconnected energy systems.
    \end{itemize}
\end{frame}

\begin{frame}{Future work}

Physics informed neural networks (PINNs) combine the strength of neural networks in learning complex patterns with the incorporation of physical principles governing the system. This hybrid approach integrates domain-specific knowledge into the neural network architecture, ensuring that the learned solutions adhere to the fundamental laws governing physical systems.
    
\end{frame}



\section{Bibliography}
\begin{frame}[allowframebreaks]
        \frametitle{References}
        \bibliographystyle{apalike}
        \bibliography{biblio}
\end{frame}




\end{document}
